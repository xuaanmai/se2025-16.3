import{_ as I,g as p,o as d,c as m,a as t,i as E,k as x,v as k,h as N,A as F,H as V,I as G,n as q,t as S,j as C,b as B,bR as D,F as T,bU as $,C as A}from"./app.c4cf1d9c.js";const U={class:"relative mx-auto p-5 border w-full max-w-lg shadow-lg rounded-md bg-white"},z={class:"mt-3"},L={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},R={class:"items-center pt-4"},H={__name:"EpicFormModal",props:{projectId:{type:[String,Number],required:!0}},emits:["close","save"],setup(f,{emit:g}){const v=f,r=g,o=p({name:"",project_id:v.projectId,starts_at:"",ends_at:""}),u=()=>{r("save",{...o.value})};return(c,e)=>(d(),m("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center",onClick:e[4]||(e[4]=E(n=>c.$emit("close"),["self"]))},[t("div",U,[t("div",z,[e[9]||(e[9]=t("h3",{class:"text-lg leading-6 font-medium text-gray-900 text-center"},"Create New Epic",-1)),t("form",{onSubmit:E(u,["prevent"]),class:"mt-4 px-4 py-3 text-left space-y-4"},[t("div",null,[e[5]||(e[5]=t("label",{for:"epic-name",class:"block text-sm font-medium text-gray-700"},"Epic Name",-1)),x(t("input",{type:"text",id:"epic-name","onUpdate:modelValue":e[0]||(e[0]=n=>o.value.name=n),required:"",class:"mt-1 form-input"},null,512),[[k,o.value.name]])]),t("div",L,[t("div",null,[e[6]||(e[6]=t("label",{for:"epic-start-date",class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),x(t("input",{type:"date",id:"epic-start-date","onUpdate:modelValue":e[1]||(e[1]=n=>o.value.starts_at=n),class:"mt-1 form-input"},null,512),[[k,o.value.starts_at]])]),t("div",null,[e[7]||(e[7]=t("label",{for:"epic-end-date",class:"block text-sm font-medium text-gray-700"},"End Date",-1)),x(t("input",{type:"date",id:"epic-end-date","onUpdate:modelValue":e[2]||(e[2]=n=>o.value.ends_at=n),class:"mt-1 form-input"},null,512),[[k,o.value.ends_at]])])]),t("div",R,[e[8]||(e[8]=t("button",{type:"submit",class:"w-full px-4 py-2 bg-blue-600 text-white text-base font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"}," Save Epic ",-1)),t("button",{type:"button",onClick:e[3]||(e[3]=n=>c.$emit("close")),class:"w-full px-4 py-2 mt-2 bg-gray-200 text-gray-800 text-base font-medium rounded-md shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500"}," Cancel ")])],32)])])]))}},W=I(H,[["__scopeId","data-v-bace49aa"]]);const K={class:"bg-white p-6 rounded-xl shadow-sm border border-gray-100"},O={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6"},P={class:"flex items-center gap-2 bg-gray-50 p-1 rounded-lg border border-gray-200"},Q=["onClick"],J={class:"relative min-h-[400px] border border-gray-100 rounded-xl overflow-hidden bg-gray-50/30"},X={key:0,class:"absolute inset-0 flex items-center justify-center bg-white/80 z-10"},Y={key:1,class:"p-10 text-center text-red-500 flex flex-col items-center"},Z={class:"gantt-target-wrapper overflow-auto"},et={__name:"GanttChart",props:{projectId:{type:String,required:!0}},setup(f){const g=f,v=p(null),r=p(!0),o=p(null),u=p(!1),c=p("Week");let e=null;const n=l=>{c.value=l,e&&e.change_view_mode(l)},M=async l=>{try{await $.post("/api/epics",l),u.value=!1,y()}catch(s){console.error("Failed to save epic:",s)}},y=async()=>{const l=window.Gantt;if(!(!l||!g.projectId)){r.value=!0,o.value=null;try{const a=(await $.get(`/api/projects/${g.projectId}/roadmap`)).data;if(!a||a.length===0){o.value="Ch\u01B0a c\xF3 Epic n\xE0o. H\xE3y t\u1EA1o m\u1EDBi \u0111\u1EC3 x\xE2y d\u1EF1ng l\u1ED9 tr\xECnh.",r.value=!1,e&&e.refresh([]);return}await A();const j={view_mode:c.value,language:"en",bar_height:30,padding:18,header_height:60,column_width:40,custom_popup_html:b=>b.custom_popup_html||""};e?e.refresh(a):e=new l(v.value,a,j),await A();const w=v.value;if(w&&!w.querySelector("#progress-gradient")){const b=document.createElementNS("http://www.w3.org/2000/svg","defs"),i=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");i.setAttribute("id","progress-gradient"),i.setAttribute("x1","0%"),i.setAttribute("y1","0%"),i.setAttribute("x2","100%"),i.setAttribute("y2","0%");const h=document.createElementNS("http://www.w3.org/2000/svg","stop");h.setAttribute("offset","0%"),h.setAttribute("style","stop-color:#60a5fa;stop-opacity:1");const _=document.createElementNS("http://www.w3.org/2000/svg","stop");_.setAttribute("offset","100%"),_.setAttribute("style","stop-color:#2563eb;stop-opacity:1"),i.appendChild(h),i.appendChild(_),b.appendChild(i),w.prepend(b)}}catch(s){console.error(s),o.value="Kh\xF4ng th\u1EC3 t\u1EA3i d\u1EEF li\u1EC7u l\u1ED9 tr\xECnh."}finally{r.value=!1}}};return N(y),F(()=>g.projectId,y),(l,s)=>(d(),m("div",K,[t("div",O,[s[2]||(s[2]=t("div",null,[t("h3",{class:"font-bold text-xl text-gray-900"},"Project Roadmap"),t("p",{class:"text-sm text-gray-500"},"Qu\u1EA3n l\xFD ti\u1EBFn \u0111\u1ED9 Epics v\xE0 c\xE1c Ticket li\xEAn quan")],-1)),t("div",P,[(d(),m(V,null,G(["Day","Week","Month"],a=>t("button",{key:a,onClick:j=>n(a),class:q([c.value===a?"bg-white shadow-sm text-blue-600":"text-gray-500 hover:text-gray-700","px-3 py-1.5 rounded-md text-xs font-semibold transition-all"])},S(a),11,Q)),64))]),t("button",{onClick:s[0]||(s[0]=a=>u.value=!0),class:"px-5 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm shadow-sm"}," + Create Epic ")]),t("div",J,[r.value?(d(),m("div",X,[...s[3]||(s[3]=[t("div",{class:"flex flex-col items-center gap-2"},[t("div",{class:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),t("span",{class:"text-sm font-medium text-gray-600"},"\u0110ang t\u1EA3i l\u1ED9 tr\xECnh...")],-1)])])):C("",!0),!r.value&&o.value?(d(),m("div",Y,[s[4]||(s[4]=t("svg",{class:"w-12 h-12 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),B(" "+S(o.value),1)])):C("",!0),x(t("div",Z,[(d(),m("svg",{ref_key:"ganttContainer",ref:v,class:"gantt-chart"},null,512))],512),[[D,!r.value&&!o.value]])]),u.value?(d(),T(W,{key:0,"project-id":f.projectId,onClose:s[1]||(s[1]=a=>u.value=!1),onSave:M},null,8,["project-id"])):C("",!0)]))}};export{et as _};
