import{m as h,p as s}from"./app.0ff6d003.js";const k=h("tickets",{state:()=>({tickets:[],ticket:null,pagination:{currentPage:1,totalPages:1,total:0,perPage:15},loading:!1,error:null}),actions:{async fetchTickets(t=1,e={}){this.loading=!0,this.error=null;try{const a=Object.fromEntries(Object.entries(e).filter(([d,n])=>n!=null&&n!=="")),r={page:t,...a},c=(await s.get("/tickets",{params:r})).data||{},o=c.meta||{},l=c.data||[];this.tickets=l,this.pagination={currentPage:o.current_page||1,totalPages:o.last_page||1,total:o.total||0,perPage:o.per_page||15}}catch(a){this.error="Failed to fetch tickets.",console.error(a)}finally{this.loading=!1}},async fetchTicket(t){this.loading=!0,this.error=null,this.ticket=null;try{const e=await s.get(`/tickets/${t}`);this.ticket=e.data.data}catch(e){this.error="Failed to fetch ticket details.",console.error(e)}finally{this.loading=!1}},async createTicket(t){var e,a;this.loading=!0,this.error=null;try{const r=await s.post("/tickets",t);return await this.fetchTickets(),r.data.data}catch(r){throw this.error=((a=(e=r.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to create ticket.",console.error(r),r}finally{this.loading=!1}},async updateTicket(t,e){var a,r;this.loading=!0,this.error=null;try{const i=await s.put(`/tickets/${t}`,e);return await this.fetchTickets(this.pagination.currentPage),this.ticket&&this.ticket.id===t&&(this.ticket=i.data.data),i.data.data}catch(i){throw this.error=((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to update ticket.",console.error(i),i}finally{this.loading=!1}},async deleteTicket(t){this.loading=!0,this.error=null;try{await s.delete(`/tickets/${t}`),await this.fetchTickets(this.pagination.currentPage)}catch(e){throw this.error="Failed to delete ticket.",console.error(e),e}finally{this.loading=!1}},async fetchComments(t){try{const e=await s.get(`/tickets/${t}/comments`);this.ticket&&this.ticket.id==t&&(this.ticket.comments=e.data.data)}catch(e){console.error("Failed to fetch comments:",e)}},async postComment(t,e){try{await s.post(`/tickets/${t}/comments`,e),await this.fetchComments(t)}catch(a){throw console.error("Failed to post comment:",a),a}},async fetchHours(t){try{const e=await s.get(`/tickets/${t}/hours`);this.ticket&&this.ticket.id==t&&(this.ticket.hours=e.data.data,this.ticket.total_logged_hours=e.data.total)}catch(e){console.error("Failed to fetch hours:",e)}},async logHours(t,e){try{await s.post(`/tickets/${t}/hours`,e),await this.fetchHours(t)}catch(a){throw console.error("Failed to log hours:",a),a}},async fetchOpenTickets(){this.loading=!0;try{const t=await s.get("/tickets/open");this.tickets=t.data.data}catch(t){console.error(t),this.error="Failed to fetch open tickets"}finally{this.loading=!1}},async fetchTicketsInProgress(){this.loading=!0;try{const t=await s.get("/tickets/in-progress");this.tickets=t.data.data}catch(t){console.error(t),this.error="Failed to fetch tickets in progress"}finally{this.loading=!1}}}});export{k as u};
