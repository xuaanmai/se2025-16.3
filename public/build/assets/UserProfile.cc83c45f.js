import{E as b,o as u,c,a as s,t as g,H as w,I as h,n as k,j as x,_ as $,g as p,i as C,k as f,v,p as _,h as U,d as y,F as E}from"./app.c4cf1d9c.js";const M={class:"bg-white p-6 rounded-lg shadow-md text-center"},j=["src","alt"],N={class:"text-2xl font-bold text-gray-800"},P={class:"text-gray-500"},V={key:0,class:"mt-4 flex justify-center flex-wrap gap-2"},B={__name:"ProfileCard",props:{user:{type:Object,required:!0}},setup(o){const a=o,i=b(()=>a.user.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(a.user.name)}&background=0D8ABC&color=fff`),d=t=>({manager:"bg-blue-100 text-blue-800",member:"bg-green-100 text-green-800",viewer:"bg-gray-100 text-gray-800"})[t]||"bg-gray-100 text-gray-800",n=t=>t.charAt(0).toUpperCase()+t.slice(1);return(t,r)=>{var m;return u(),c("div",M,[s("img",{class:"h-32 w-32 rounded-full object-cover mx-auto mb-4 ring-4 ring-blue-100",src:i.value,alt:o.user.name},null,8,j),s("h2",N,g(o.user.name),1),s("p",P,g(o.user.email),1),(m=o.user.roles)!=null&&m.length?(u(),c("div",V,[(u(!0),c(w,null,h(o.user.roles,e=>(u(),c("span",{key:e.id,class:k(["px-3 py-1 text-sm font-medium rounded-full",d(e.name)])},g(n(e.name)),3))),128))])):x("",!0)])}}},H={class:"bg-white p-6 rounded-lg shadow-md flex flex-col items-center justify-center"},F={class:"relative w-40 h-40"},I={class:"w-full h-full",viewBox:"0 0 36 36"},S=["stroke-dashoffset"],q={class:"absolute inset-0 flex flex-col items-center justify-center"},z={class:"text-3xl font-bold text-gray-800"},D=15.9155,L={__name:"StatsGauge",props:{hours:{type:Number,default:0},maxHours:{type:Number,default:100}},setup(o){const a=o,i=2*Math.PI*D,d=b(()=>Number.isFinite(a.hours)?a.hours:0),n=b(()=>{const t=Math.min(d.value/a.maxHours,1);return i*(1-t)});return(t,r)=>(u(),c("div",H,[r[2]||(r[2]=s("h3",{class:"font-semibold text-lg text-gray-800 mb-2"},"Total Hours Logged",-1)),s("div",F,[(u(),c("svg",I,[r[0]||(r[0]=s("path",{class:"text-gray-200",d:`M18 2.0845\r
            a 15.9155 15.9155 0 0 1 0 31.831\r
            a 15.9155 15.9155 0 0 1 0 -31.831`,fill:"none",stroke:"currentColor","stroke-width":"3"},null,-1)),s("path",{class:"text-blue-500","stroke-dasharray":i,"stroke-dashoffset":n.value,d:`M18 2.0845\r
            a 15.9155 15.9155 0 0 1 0 31.831\r
            a 15.9155 15.9155 0 0 1 0 -31.831`,fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round"},null,8,S)])),s("div",q,[s("span",z,g(o.hours),1),r[1]||(r[1]=s("span",{class:"text-sm text-gray-500"},"hours",-1))])])]))}};const O={class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},A={class:"bg-white w-full max-w-md rounded-lg p-6"},R={class:"flex justify-end gap-2 pt-2"},T=["disabled"],G={__name:"EditProfileModal",props:{user:Object},emits:["close","updated"],setup(o,{emit:a}){const i=o,d=a,n=p(!1),t=p({name:i.user.name,email:i.user.email,current_password:"",password:"",password_confirmation:""}),r=async()=>{var m,e;n.value=!0;try{const l=await _.put("/users/me",t.value);d("updated",l.data.data),d("close")}catch(l){alert(((e=(m=l.response)==null?void 0:m.data)==null?void 0:e.message)||"Update failed")}finally{n.value=!1}};return(m,e)=>(u(),c("div",O,[s("div",A,[e[12]||(e[12]=s("h3",{class:"text-lg font-semibold mb-4"},"Edit Profile",-1)),s("form",{onSubmit:C(r,["prevent"]),class:"space-y-4"},[s("div",null,[e[6]||(e[6]=s("label",{class:"block text-sm font-medium mb-1"},"Name",-1)),f(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.name=l),class:"input",required:""},null,512),[[v,t.value.name]])]),s("div",null,[e[7]||(e[7]=s("label",{class:"block text-sm font-medium mb-1"},"Email",-1)),f(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.email=l),type:"email",class:"input",required:""},null,512),[[v,t.value.email]])]),e[11]||(e[11]=s("hr",null,null,-1)),s("div",null,[e[8]||(e[8]=s("label",{class:"block text-sm font-medium mb-1"},"Current password",-1)),f(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.current_password=l),type:"password",class:"input"},null,512),[[v,t.value.current_password]])]),s("div",null,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium mb-1"},"New password",-1)),f(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.password=l),type:"password",class:"input"},null,512),[[v,t.value.password]])]),s("div",null,[e[10]||(e[10]=s("label",{class:"block text-sm font-medium mb-1"},"Confirm password",-1)),f(s("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.password_confirmation=l),type:"password",class:"input"},null,512),[[v,t.value.password_confirmation]])]),s("div",R,[s("button",{type:"button",onClick:e[5]||(e[5]=l=>m.$emit("close"))}," Cancel "),s("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded",disabled:n.value}," Save ",8,T)])],32)])]))}},J=$(G,[["__scopeId","data-v-340d9669"]]),K={key:0,class:"text-center py-10"},Q={key:1,class:"text-red-500 text-center py-10"},W={key:2,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},X={class:"lg:col-span-1 space-y-6"},Y={class:"lg:col-span-2 space-y-6"},se={__name:"UserProfile",setup(o){const a=p(null),i=p(!1),d=p(null),n=p(!1),t=async()=>{i.value=!0,d.value=null;try{const e=await _.get("/users/me");a.value=e.data.data}catch{d.value="Failed to load user profile."}finally{i.value=!1}},r=()=>{n.value=!1},m=async()=>{n.value=!1,await t()};return U(t),(e,l)=>(u(),c("div",null,[i.value?(u(),c("div",K," Loading... ")):d.value?(u(),c("div",Q,g(d.value),1)):a.value?(u(),c("div",W,[s("div",X,[y(B,{user:a.value},null,8,["user"]),s("button",{class:"w-full bg-blue-600 text-white py-2 rounded",onClick:l[0]||(l[0]=Z=>n.value=!0)}," Edit Profile ")]),s("div",Y,[y(L,{hours:a.value.total_logged_in_hours,"max-hours":100},null,8,["hours"])])])):x("",!0),n.value?(u(),E(J,{key:3,user:a.value,onClose:r,onUpdated:m},null,8,["user"])):x("",!0)]))}};export{se as default};
